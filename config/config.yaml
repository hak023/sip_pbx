# SIP PBX with Real-time Voice Analysis - Configuration File

# SIP ì„œë²„ ì„¤ì •
sip:
  listen_ip: "0.0.0.0"
  listen_port: 5060
  transport: "udp"  # udp, tcp, tls
  max_concurrent_calls: 100
  
  # B2BUA ì™¸ë¶€ IP (SDP c= ë¼ì¸ì— ì‚¬ìš©)
  # 0.0.0.0ìœ¼ë¡œ ë°”ì¸ë”©í•˜ë˜, SDPì—ëŠ” ì‹¤ì œ ì ‘ê·¼ ê°€ëŠ¥í•œ IPë¥¼ ë„£ì–´ì•¼ í•¨
  # advertised_ipë¥¼ ì£¼ì„ ì²˜ë¦¬í•˜ë©´ ìë™ìœ¼ë¡œ ê°ì§€ë©ë‹ˆë‹¤ (í…Œë”ë§ í™˜ê²½ì— ìµœì )
  # advertised_ip: "192.168.208.233"  # ìˆ˜ë™ ì„¤ì • (ë¹„í™œì„±í™”)
  
  # SIP íƒ€ì´ë¨¸ ì„¤ì • (RFC 3261)
  timers:
    # íŠ¸ëœì­ì…˜ íƒ€ì´ë¨¸
    t1: 0.5               # RTT Estimate (ì´ˆ) - UDP ì¬ì „ì†¡ ê¸°ë³¸ ê°„ê²©
    t2: 4.0               # ìµœëŒ€ ì¬ì „ì†¡ ê°„ê²© (ì´ˆ)
    t4: 5.0               # ìµœëŒ€ ë©”ì‹œì§€ ìˆ˜ëª… (ì´ˆ)
    
    # ì„¸ì…˜ íƒ€ì´ë¨¸
    invite_timeout: 30    # INVITE ì‘ë‹µ ëŒ€ê¸° ì‹œê°„ (ì´ˆ)
    bye_timeout: 32       # BYE ì‘ë‹µ ëŒ€ê¸° ì‹œê°„ (ì´ˆ)
    register_expires: 3600  # REGISTER ë§Œë£Œ ì‹œê°„ (ì´ˆ, 1ì‹œê°„)
    
    # Session-Expires (RFC 4028)
    session_expires: 1800  # ì„¸ì…˜ ë§Œë£Œ ì‹œê°„ (ì´ˆ, 30ë¶„)
    min_se: 90            # ìµœì†Œ ì„¸ì…˜ ê°±ì‹  ê°„ê²© (ì´ˆ)
    session_refresher: "uas"  # ì„¸ì…˜ ê°±ì‹  ì£¼ì²´ (uac/uas)
    
    # ë¶€ì¬ì¤‘ íƒ€ì„ì•„ì›ƒ (AI í™œì„±í™”)
    no_answer_timeout: 10  # ì°©ì‹ ì ë¬´ì‘ë‹µ ì‹œ AI í™œì„±í™” (ì´ˆ)

# ë¯¸ë””ì–´ ì²˜ë¦¬ ì„¤ì •
media:
  mode: "bypass"  # direct | bypass | reflecting
                  # - direct: SDP ìˆ˜ì •í•˜ì§€ ì•ŠìŒ, ë‹¨ë§ê°„ ì§ì ‘ RTP í†µì‹  (í…ŒìŠ¤íŠ¸ìš©)
                  # - bypass: B2BUAê°€ RTP ì¤‘ê³„ (ë…¹ìŒ/ë¶„ì„ ê°€ëŠ¥)
                  # - reflecting: B2BUAê°€ RTP ì¤‘ê³„ + AI ë¶„ì„
  
  # RTP ì†Œì¼“ bind IP
  # - íŠ¹ì • IP: í•´ë‹¹ IPì—ë§Œ bind (ë³´ì•ˆ ê°•í™”)
  # - "0.0.0.0": ëª¨ë“  ì¸í„°í˜ì´ìŠ¤ì—ì„œ ìˆ˜ì‹  (í˜¸í™˜ì„± ìµœëŒ€í™”)
  rtp_bind_ip: "0.0.0.0"  # ë‹¨ë§ ë„¤íŠ¸ì›Œí¬ ë¬¸ì œ ì‹œ 0.0.0.0 ê¶Œì¥
  
  port_pool:
    start: 10000 
    end: 10100    # ğŸ§ª í…ŒìŠ¤íŠ¸: ì¶©ë¶„í•œ í¬íŠ¸ ë²”ìœ„
  rtp_timeout: 60  # seconds without RTP â†’ auto-terminate
  codec_priority:
    - "opus"
    - "pcmu"  # G.711 Î¼-law
    - "pcma"  # G.711 A-law

# AI ë¶„ì„ ì„¤ì • (ê¸°ì¡´ - í†µí™” ì¤‘ ë¶„ì„)
ai:
  enabled: true
  
  stt:
    model: "faster-whisper-large-v3"
    device: "cuda"  # cuda | cpu
    language: "auto"  # auto, ko, en
    beam_size: 5
    vad_filter: true
    
  emotion:
    model: "speechbrain/emotion-recognition"
    device: "cuda"
    threshold: 0.7  # 0.0 - 1.0
    sample_rate: 16000
    
  text_classifier:
    model_korean: "beomi/KcELECTRA-base"
    model_english: "distilbert-base-uncased"
    device: "cuda"
    threshold: 0.8  # 0.0 - 1.0
    
  profanity_dict:
    path: "config/profanity_dict.yaml"
    enabled: true

# =============================================================================
# AI ë³´ì´ìŠ¤ë´‡ ì„¤ì • (ì‹ ê·œ - ë¶€ì¬ì¤‘ ìë™ ì‘ë‹µ)
# =============================================================================
ai_voicebot:
  enabled: true  # AI ë³´ì´ìŠ¤ë´‡ í™œì„±í™” ì—¬ë¶€
  
  # ë¶€ì¬ì¤‘ ì„¤ì •
  no_answer_timeout: 10  # ì´ˆ (ì°©ì‹ ìê°€ ì´ ì‹œê°„ ë™ì•ˆ ì‘ë‹µ ì—†ìœ¼ë©´ AI í™œì„±í™”)
  
  # ê³ ì • ì¸ì‚¬ë§
  greeting_message: "ì•ˆë…•í•˜ì„¸ìš”, AI ë¹„ì„œì…ë‹ˆë‹¤. ë¬´ì—‡ì„ ë„ì™€ë“œë¦´ê¹Œìš”?"
  
  # â­ Google Cloud ì„¤ì • - ì—¬ê¸°ì— API ì •ë³´ ì…ë ¥! â­
  google_cloud:
    project_id: "sip-pbx-ai"  # â† Google Cloud í”„ë¡œì íŠ¸ ID
    credentials_path: "config/gcp-key.json"  # â† Service Account í‚¤ íŒŒì¼ ê²½ë¡œ
    
    # Quota ê´€ë¦¬
    quota_management:
      daily_request_limit: 1000  # ì¼ì¼ ìš”ì²­ ì œí•œ
      cost_alert_threshold_usd: 50  # ë¹„ìš© ì•ŒëŒ ì„ê³„ê°’ (ë‹¬ëŸ¬)
      auto_throttle_enabled: true
    
    # STT (Speech-to-Text) ì„¤ì •
    stt:
      model: "telephony"  # telephony | latest_long
      language_code: "ko-KR"  # ko-KR | en-US
      sample_rate: 16000
      enable_enhanced: true
      enable_automatic_punctuation: true
    
    # TTS (Text-to-Speech) ì„¤ì •
    tts:
      voice_name: "ko-KR-Chirp3-HD-Kore"  # Chirp3 HD ì—¬ì„± ëª©ì†Œë¦¬ (Streaming TTS ì§€ì›)
      language_code: "ko"  # ìŒì„± ì–¸ì–´ ì½”ë“œ (ko | en) - voice_nameì˜ ì–¸ì–´ì™€ ì¼ì¹˜í•´ì•¼ í•¨
      speaking_rate: 1.0  # 0.25 - 4.0 (1.0 = ë³´í†µ ì†ë„)
      pitch: 0.0  # -20.0 - 20.0 (0 = ë³´í†µ ìŒë†’ì´)
    
    # Gemini LLM ì„¤ì •
    gemini:
      # ğŸš€ ê¶Œì¥ ëª¨ë¸ (2026ë…„ 1ì›” ê¸°ì¤€):
      #   1. gemini-2.5-flash (ìµœì‹  ì•ˆì •íŒ, ê°€ì¥ ë¹ ë¥´ê³  ì €ë ´, ì…ë ¥ 100ë§Œ í† í°)
      #   2. gemini-flash-latest (í•­ìƒ ìµœì‹  Flash ë²„ì „ìœ¼ë¡œ ìë™ ì—…ë°ì´íŠ¸)
      #   3. gemini-2.0-flash (ì•ˆì •ì )
      #   4. gemini-2.5-flash-lite (ë” ë¹ ë¥´ê³  ì €ë ´, ê²½ëŸ‰ ì‘ë‹µìš©)
      # 
      # ğŸ’° ë¹„ìš© ë¹„êµ (100ë§Œ í† í°):
      #   - Flash 2.5: $0.075 (ì…ë ¥) / $0.30 (ì¶œë ¥) â†’ ì›” ~â‚©1,400 (100í†µ ê¸°ì¤€)
      #   - Pro 2.5:   $1.25 (ì…ë ¥) / $5.00 (ì¶œë ¥) â†’ ì›” ~â‚©23,400 (100í†µ ê¸°ì¤€)
      # âš¡ ì‘ë‹µ ì†ë„:
      #   - Flash 2.5: 300~600ms (ì§§ì€ ë‹µë³€, ìµœê³  ì†ë„)
      #   - Flash 2.0: 400~700ms (ì§§ì€ ë‹µë³€)
      #   - Pro 2.5:   800~1200ms (ì§§ì€ ë‹µë³€)
      # ğŸ“Š í’ˆì§ˆ: ê°„ë‹¨í•œ ëŒ€í™”(1~2ë¬¸ì¥)ì—ì„œëŠ” Flashì™€ Pro ì°¨ì´ ë¯¸ë¯¸
      model: "gemini-2.5-flash"  # gemini-2.5-flash (ìµœì‹ ) | gemini-flash-latest | gemini-2.0-flash | gemini-2.5-flash-lite
      
      # â­ Gemini API í‚¤ (í•„ìˆ˜)
      # ë°œê¸‰: https://aistudio.google.com/app/apikey
      api_key: "AIzaSyCVg4n1vYhudl9Y78r_MkX82k4liUQ9Yss"
      
      temperature: 0.5  # 0.0 - 1.0 (ë‚®ì„ìˆ˜ë¡ ì¼ê´€ì ì´ê³  ë¹ ë¦„, 0.5 ê¶Œì¥)
      max_output_tokens: 500  # ëŒ€í™” ìƒì„± ë“± ê¸°ë³¸ ìµœëŒ€ ì¶œë ¥ í† í°
      # í†µí™” ì§€ì‹ ì •ì œ(judge_usefulness) JSON ì¶œë ¥ìš©. ì„¤ê³„ ê¶Œì¥: 1024 ì´ìƒ, ì˜ë¦¼ ë°œìƒ ì‹œ 2048
      judgment_max_output_tokens: 1024
      # ì§€ì‹ ì •ì œ ì‹œ LLMì— ë„£ëŠ” ì „ì‚¬ ë¬¸ì ìƒí•œ (ê¸´ í†µí™” ì²˜ë¦¬). ì„¤ê³„ì„œ 2.2a
      judgment_max_input_chars: 6000
      
      # ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ (ê°„ê²°í•œ ì‘ë‹µ ìœ ë„)
      system_prompt: |
        ë‹¹ì‹ ì€ ì „í™” ì‘ëŒ€ AI ë¹„ì„œì…ë‹ˆë‹¤.
        ê·œì¹™:
        1. 1~2ë¬¸ì¥ìœ¼ë¡œ ê°„ê²°í•˜ê²Œ ë‹µë³€í•˜ì„¸ìš”.
        2. ë¶ˆí•„ìš”í•œ ì¸ì‚¬ë§ì´ë‚˜ ë¶€ì—° ì„¤ëª…ì„ ìƒëµí•˜ì„¸ìš”.
        3. ì§ˆë¬¸ì˜ í•µì‹¬ë§Œ ëª…í™•í•˜ê²Œ ì „ë‹¬í•˜ì„¸ìš”.
        4. ëª¨ë¥´ëŠ” ë‚´ìš©ì€ ì†”ì§íˆ "ì˜ ëª¨ë¥´ê² ìŠµë‹ˆë‹¤"ë¼ê³  ë‹µë³€í•˜ì„¸ìš”.
  
  # Resilience (ì¬ì‹œë„ ë° Circuit Breaker)
  resilience:
    retry:
      max_attempts: 3  # ìµœëŒ€ ì¬ì‹œë„ íšŸìˆ˜
      backoff_multiplier: 2  # ë°±ì˜¤í”„ ë°°ìœ¨
      min_wait_seconds: 2  # ìµœì†Œ ëŒ€ê¸° ì‹œê°„
      max_wait_seconds: 10  # ìµœëŒ€ ëŒ€ê¸° ì‹œê°„
    
    circuit_breaker:
      failure_threshold: 5  # ì‹¤íŒ¨ ì„ê³„ê°’ (5íšŒ ì‹¤íŒ¨ ì‹œ open)
      timeout_seconds: 60  # Open ìƒíƒœ ìœ ì§€ ì‹œê°„
      half_open_max_calls: 3  # Half-open ìƒíƒœ í…ŒìŠ¤íŠ¸ í˜¸ì¶œ ìˆ˜

  # HITL (Human-in-the-Loop) - RAG ë¶€ì¡± ì‹œ ë‹´ë‹¹ì ë¬¸ì˜, timeout ì‹œ ì•ˆë‚´ í›„ ì¢…ë£Œ
  hitl:
    timeout_seconds: 15  # ë‹´ë‹¹ì ì‘ë‹µ ëŒ€ê¸° ì‹œê°„ (ì´ˆ)
    timeout_message: "í™•ì¸ì´ ì§€ì—°ë˜ê³  ìˆìŠµë‹ˆë‹¤. í™•ì¸ë˜ëŠ” ëŒ€ë¡œ ì—°ë½ ë“œë¦¬ê² ìŠµë‹ˆë‹¤."  # timeout ì‹œ ê³ ê°ì—ê²Œ TTS ì¬ìƒ í›„ í†µí™” ì¢…ë£Œ
    away_message: "ì£„ì†¡í•©ë‹ˆë‹¤. í•´ë‹¹ ë¶€ë¶„ì€ ì˜ ëª¨ë¥´ëŠ” ë‚´ìš©ì´ë¼ í™•ì¸ í›„ ë³„ë„ë¡œ ì•ˆë‚´ë“œë¦¬ê² ìŠµë‹ˆë‹¤."  # ìš´ì˜ì ë¶€ì¬ì¤‘ ì‹œ fallback
  
  # Vector DB ì„¤ì •
  vector_db:
    provider: "chromadb"  # chromadb | pinecone
    
    # ChromaDB (ê°œë°œ/ë¡œì»¬)
    chromadb:
      persist_directory: "./data/chromadb"
    
    # Pinecone (í”„ë¡œë•ì…˜) - ì‚¬ìš© ì‹œ ì£¼ì„ í•´ì œ
    # pinecone:
    #   api_key: "${PINECONE_API_KEY}"  # í™˜ê²½ ë³€ìˆ˜ì—ì„œ ë¡œë“œ
    #   environment: "us-west1-gcp"
    #   index_name: "knowledge-base"
    #   dimension: 768  # Sentence Transformers ì°¨ì›
  
  # Embedding ì„¤ì •
  embedding:
    model: "paraphrase-multilingual-mpnet-base-v2"  # Sentence Transformers ëª¨ë¸
    dimension: 768
    batch_size: 32
  
  # RAG ì„¤ì •
  rag:
    top_k: 3  # ê²€ìƒ‰í•  ë¬¸ì„œ ìˆ˜
    similarity_threshold: 0.7  # ìœ ì‚¬ë„ ì„ê³„ê°’ (0.0 - 1.0)
    reranking_enabled: false  # ì¬ìˆœìœ„í™” í™œì„±í™”
  
  # Knowledge Extraction ì„¤ì •
  knowledge_extractor:
    min_text_length: 10  # ìµœì†Œ í…ìŠ¤íŠ¸ ê¸¸ì´ (ë¬¸ì ìˆ˜)
    min_confidence: 0.7  # ìµœì†Œ ì‹ ë¢°ë„ (LLM íŒë‹¨)
    chunk_size: 500  # ì²­í¬ í¬ê¸°
    chunk_overlap: 50  # ì²­í¬ ì˜¤ë²„ë©
    # Â§7 PII íŒŒì´í”„ë¼ì¸: contains_piiì¸ í•­ëª©ì„ VectorDBì— ë°”ë¡œ ë„£ì§€ ì•Šê³  ê²€í†  ëŒ€ê¸°ì—´ì— ì ì¬
    pii_review_queue_enabled: false  # true ì‹œ PII í¬í•¨ ì¶”ì¶œì€ pending ê²€í†  í›„ ë°˜ì˜
    extraction_pending_file: "data/extraction_pending_review.jsonl"  # ê²€í†  ëŒ€ê¸°ì—´ íŒŒì¼ ê²½ë¡œ
  
  # ë…¹ìŒ ì„¤ì •
  recording:
    enabled: true
    output_dir: "./recordings"
    format: "wav"
    sample_rate: 16000
    
    # í›„ì²˜ë¦¬ STT (Speech-to-Text)
    post_processing_stt:
      enabled: true  # âœ… í™œì„±í™” (Google Cloud ì¸ì¦ ì •ë³´ ì„¤ì • í›„)
      language: "ko-KR"  # ko-KR | en-US | ja-JP ë“±
      enable_diarization: true  # í™”ì ë¶„ë¦¬ (caller/callee)
      model: "telephony"  # Google STT ëª¨ë¸ (ì „í™” í†µí™” ìµœì í™”)
      enable_automatic_punctuation: true  # ìë™ êµ¬ë‘ì 
      enable_word_time_offsets: true  # ë‹¨ì–´ë³„ íƒ€ì„ìŠ¤íƒ¬í”„
    
    # ì§€ì‹ ì¶”ì¶œ
    knowledge_extraction:
      enabled: true
      version: "v2"                    # v1 (ê¸°ì¡´ ë‹¨ì¼ LLM) | v2 (ë©€í‹°ìŠ¤í… íŒŒì´í”„ë¼ì¸)
      
      # ì¶”ì¶œ ìŠ¤í… ì„¤ì •
      steps:
        summarize: true                # Step 1: ëŒ€í™” ìš”ì•½
        qa_extract: true               # Step 2: QA ìŒ ì¶”ì¶œ
        entity_extract: true           # Step 3: ì—”í‹°í‹° ì¶”ì¶œ
      
      # í’ˆì§ˆ ê²€ì¦
      quality:
        min_confidence: 0.7            # ìµœì†Œ ì‹ ë¢°ë„
        hallucination_check: true      # í™˜ê° ê²€ì¦ í™œì„±í™”
        deduplication: true            # ì¤‘ë³µ ê²€ì¦ í™œì„±í™”
        dedup_threshold: 0.92          # ì¤‘ë³µ íŒì • ì½”ì‚¬ì¸ ìœ ì‚¬ë„
        near_dedup_threshold: 0.85     # ë³‘í•© í›„ë³´ ì½”ì‚¬ì¸ ìœ ì‚¬ë„
      
      # ìë™ ìŠ¹ì¸
      auto_approve:
        enabled: true
        min_confidence: 0.9            # ìë™ ìŠ¹ì¸ ìµœì†Œ ì‹ ë¢°ë„
        require_hallucination_pass: true
      
      # ì²­í‚¹
      chunk_size: 500                  # ë¬¸ì
      chunk_overlap: 50                # ë¬¸ì
      min_text_length: 10
      
      # ë¹„ìš© ì œì–´
      max_llm_calls_per_extraction: 6  # ì¶”ì¶œë‹¹ ìµœëŒ€ LLM í˜¸ì¶œ ìˆ˜
      skip_short_calls_seconds: 30     # 30ì´ˆ ë¯¸ë§Œ í†µí™” ìŠ¤í‚µ
  
  # VAD (Voice Activity Detection)
  vad:
    enabled: true
    mode: 3  # 0-3 (3ì´ ê°€ì¥ ë¯¼ê°)
    frame_duration_ms: 30  # 10 | 20 | 30
  
  # Barge-in ì„¤ì • (Phase 3: Smart Barge-in)
  barge_in:
    enabled: true
    vad_threshold: 0.5  # ìŒì„± ê°ì§€ ì„ê³„ê°’
    speech_frame_count: 3  # ì—°ì† ìŒì„± í”„ë ˆì„ ìˆ˜
    min_words: 3  # LLM íŒë‹¨ ê¸°ì¤€ ìµœì†Œ ë‹¨ì–´ ìˆ˜
    # keywords: null  # ì»¤ìŠ¤í…€ ì¦‰ì‹œì¤‘ë‹¨ í‚¤ì›Œë“œ (nullì´ë©´ ê¸°ë³¸ê°’ ì‚¬ìš©)
  
  # Streaming TTS ì„¤ì • (Phase 3)
  streaming_tts:
    enabled: true
    min_chunk_chars: 15  # TTS ìµœì†Œ ì „ì†¡ ë¬¸ì ìˆ˜
    max_buffer_chars: 200  # ê°•ì œ í”ŒëŸ¬ì‹œ ë¬¸ì ìˆ˜
    flush_timeout: 1.0  # ë¬´ì…ë ¥ ì‹œ í”ŒëŸ¬ì‹œ íƒ€ì„ì•„ì›ƒ (ì´ˆ)
  
  # Silero VAD (Pipecat íŒŒì´í”„ë¼ì¸ â€” ë°œí™” ì‹œì‘/ì¢…ë£Œ ê°ì§€)
  # STT ë‹¨í¸í™” ë°©ì§€: ë°œí™”ìÂ·ìˆ˜ì‹ ìê°€ ê°™ì€ ê³µê°„ì´ë©´ ì–‘ìª½ ìŒì„±ì´ í•œ ìŠ¤íŠ¸ë¦¼ì— ì„ì—¬,
  # ì¹¨ë¬µì´ ì§§ê²Œ ëŠê¸°ë¯€ë¡œ stop_secsë¥¼ ë„‰ë„‰íˆ ì£¼ì–´ ë¬¸ì¥ ë‹¨ìœ„ë¡œ ì¸ì‹ë˜ë„ë¡ í•¨.
  # ë„ˆë¬´ ì§§ìœ¼ë©´ "ë§ˆë””ë§ˆë””ë§ˆë‹¤ ì§§ê²Œ ëŠê¹€"; 1.0~1.2ì´ˆ ê¶Œì¥.
  silero_vad:
    stop_secs: 1.0   # ì¹¨ë¬µ ì´ ê¸¸ì–´ì ¸ì•¼ "ë°œí™” ì¢…ë£Œ" (0.7â†’1.0: ë¬¸ì¥ ë‹¨ìœ„ ìœ ë„, 1.2ë„ ê°€ëŠ¥)
    start_secs: 0.3  # ìŒì„± ì‹œì‘ìœ¼ë¡œ ì¸ì •í•  ìµœì†Œ êµ¬ê°„ (0.25â†’0.3: ì§§ì€ ë…¸ì´ì¦ˆ ì–µì œ)
    confidence: 0.5   # ìŒì„± íŒë³„ ìµœì†Œ ì‹ ë¢°ë„ (0.6â†’0.5: ì–‘ìª½ ìŒì„± í˜¼í•© ì‹œ ë‹¨ì ˆ ì™„í™”)
    min_volume: 0.5   # ìµœì†Œ ë³¼ë¥¨ (0~1)
  
  # Smart Turn ì„¤ì • (ë°œí™” ì¢…ë£Œ ê°ì§€)
  # VAD ì¹¨ë¬µ í›„ ë¬¸ë²•/ì–µì–‘ìœ¼ë¡œ "ì§„ì§œ ë"ì¸ì§€ íŒë‹¨. max_hold_secsë¥¼ ëŠ˜ë¦¬ë©´ ì§§ì€ ë©ˆì¶¤ì—ì„œ ëœ ì˜ë¦¼.
  smart_turn:
    enabled: true  # Smart Turn v3.2 í™œì„±í™” (falseë©´ Silero VAD stop_secs ì¹¨ë¬µë§Œ ì‚¬ìš©)
    # model_path: null  # ì»¤ìŠ¤í…€ ONNX ëª¨ë¸ ê²½ë¡œ (nullì´ë©´ Pipecat ë²ˆë“¤ ì‚¬ìš©)
    max_hold_secs: 2.5  # ë°œí™” ë¯¸ì™„ íŒë‹¨ ì‹œ ìµœëŒ€ ëŒ€ê¸° ì‹œê°„ (2.0â†’2.5: ë¬¸ì¥ ì™„ì„±ê¹Œì§€ ëŒ€ê¸°)
  
  # í˜¸ ì „í™˜(Transfer) ì„¤ì •
  transfer:
    enabled: true
    ring_timeout: 30              # ì°©ì‹  ëŒ€ê¸° ì‹œê°„ (ì´ˆ)
    announcement_mode: "template" # template | llm
    announcement_template: >
      {department}ë¡œ ì „í™” ì—°ê²°í•˜ê² ìŠµë‹ˆë‹¤.
      ì—°ê²°ë˜ëŠ” ì „í™”ë²ˆí˜¸ëŠ” {phone}ì…ë‹ˆë‹¤.
      ì—°ê²°ë˜ëŠ” ë™ì•ˆ ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.
    waiting_message: "ì—°ê²° ì¤‘ì…ë‹ˆë‹¤. ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”."
    retry_enabled: true
    max_retries: 2
    min_similarity_threshold: 0.75  # ì „í™˜ ì˜ë„ ê°ì§€ ìµœì†Œ ìœ ì‚¬ë„
    hold_music_file: null           # nullì´ë©´ TTS ëŒ€ê¸° ì•ˆë‚´ ì‚¬ìš©
  
  # AI ì•„ì›ƒë°”ìš´ë“œ ì½œ ì„¤ì •
  outbound:
    enabled: true
    # SIP Gateway ì„¤ì • (ì™¸ë¶€ ë°œì‹ ìš©)
    # ë¯¸ì„¤ì • ì‹œ ë“±ë¡ëœ ìœ ì €ë¡œë§Œ ë°œì‹  ê°€ëŠ¥
    # default_gateway: "sip:gateway.example.com:5060"
    max_concurrent_calls: 5        # ë™ì‹œ ì•„ì›ƒë°”ìš´ë“œ ì½œ ìµœëŒ€ ìˆ˜
    ring_timeout: 30               # ë§ íƒ€ì„ì•„ì›ƒ (ì´ˆ)
    max_call_duration: 300         # ìµœëŒ€ í†µí™” ì‹œê°„ (ì´ˆ, ê¸°ë³¸ 5ë¶„)
    retry:
      enabled: true
      max_retries: 2               # ìµœëŒ€ ì¬ì‹œë„ íšŸìˆ˜
      retry_interval: 300          # ì¬ì‹œë„ ê°„ê²© (ì´ˆ, ê¸°ë³¸ 5ë¶„)
      retry_on:
        - "no_answer"
        - "busy"
    ai:
      greeting_template: >
        ì•ˆë…•í•˜ì„¸ìš”, {display_name} AI ë¹„ì„œì…ë‹ˆë‹¤.
        {purpose} ê´€ë ¨í•˜ì—¬ ì—°ë½ë“œë ¸ìŠµë‹ˆë‹¤.
      closing_template: "í™•ì¸ ê°ì‚¬í•©ë‹ˆë‹¤. ì¢‹ì€ í•˜ë£¨ ë˜ì„¸ìš”."
      max_turns: 20                # ìµœëŒ€ ëŒ€í™” í„´ ìˆ˜ (ë¬´í•œ ë£¨í”„ ë°©ì§€)
      task_completion_check: true
    result:
      save_transcript: true
      save_recording: true
      generate_summary: true

  # Pipeline Engine ì„¤ì • (Phase 1+)
  # legacy: ê¸°ì¡´ Orchestrator, pipecat: Pipecat íŒŒì´í”„ë¼ì¸
  pipeline_engine: "pipecat"
  
  # ì˜¤ë””ì˜¤ ë²„í¼
  audio_buffer:
    jitter_buffer_ms: 60  # Jitter ë²„í¼ í¬ê¸°
    max_buffer_size: 100  # ìµœëŒ€ íŒ¨í‚· ìˆ˜
    target_sample_rate: 16000  # ëª©í‘œ ìƒ˜í”Œë ˆì´íŠ¸
  
  # ë¡œê¹…
  logging:
    log_conversations: true  # ëŒ€í™” ë‚´ìš© ë¡œê¹…
    log_audio: true  # ì˜¤ë””ì˜¤ ë°ì´í„° ë¡œê¹… (ë””ë²„ê·¸ìš©)
    log_level: "INFO"  # DEBUG | INFO | WARNING | ERROR
    # DB ë¡œê¹… (RAG/LLM/ì§€ì‹ë§¤ì¹­): ì„¤ì • ì‹œ asyncpgë¡œ í•´ë‹¹ í…Œì´ë¸”ì— INSERT. ë¯¸ì„¤ì • ì‹œ ìŠ¤í‚µ.
    # db_url: "postgresql://user:pass@localhost:5432/your_db"  # docs/guides/AI_DB_LOGGING_SETUP.md

# ì´ë²¤íŠ¸ ë° ì•Œë¦¼ ì„¤ì •
events:
  webhook_urls:
    - "http://localhost:5000/webhook"
  webhook_timeout: 10  # seconds
  webhook_retries: 3
  
  thresholds:
    profanity: 0.8
    anger: 0.7
    threatening: 0.75
    combined_alert: true  # profanity + anger ë™ì‹œ ë°œìƒ ì‹œ ë†’ì€ ìš°ì„ ìˆœìœ„
  
  severity_levels:
    low: 0.5
    medium: 0.7
    high: 0.85
    critical: 0.95

# CDR (Call Detail Record) ì„¤ì •
cdr:
  enabled: true
  output_dir: "/var/log/sip-pbx/cdr"
  filename_pattern: "cdr-%Y-%m-%d.jsonl"
  rotation: "daily"  # daily, hourly
  retention_days: 90

# ë¡œê¹… ì„¤ì •
logging:
  level: "INFO"  # DEBUG, INFO, WARNING, ERROR, CRITICAL
  format: "json"  # json, text
  output: "file"  # stdout, file
  file_path: "/var/log/sip-pbx/app.log"
  max_bytes: 104857600  # 100MB
  backup_count: 10

# ëª¨ë‹ˆí„°ë§ ì„¤ì •
monitoring:
  prometheus_port: 9090
  prometheus_path: "/metrics"
  health_check_port: 8080
  health_check_interval: 10  # seconds

# GPU ë¦¬ì†ŒìŠ¤ ê´€ë¦¬
gpu:
  device_id: 0  # CUDA device ID
  memory_fraction: 0.9  # Max GPU memory to use (0.0 - 1.0)
  batch_size:
    stt: 4
    emotion: 8
    text_classifier: 16

# ë³´ì•ˆ ì„¤ì •
security:
  admin_api_key: "change-me-in-production"
  webhook_secret: "change-me-in-production"
  ip_whitelist:
    enabled: false
    allowed_ips:
      - "10.0.0.0/8"
      - "172.16.0.0/12"
      - "192.168.0.0/16"

